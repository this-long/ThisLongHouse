(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{548:function(t,s,a){"use strict";a.r(s);var n=a(4),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("介绍")]),t._v(" "),a("p",[t._v("通过 json 文件创建一个本地的简易服务器"),a("br")])]),t._v(" "),a("h2",{attrs:{id:"创建简易服务器-仅本机可以访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建简易服务器-仅本机可以访问"}},[t._v("#")]),t._v(" 创建简易服务器(仅本机可以访问)")]),t._v(" "),a("p",[t._v("使用 json-server 模拟一个服务器请求")]),t._v(" "),a("ul",[a("li",[t._v("1：在项目文件夹最外层创建一个 data 文件夹（严禁放在 src 内,在 src 内还需要运行 vue 的服务器。）")]),t._v(" "),a("li",[t._v("2：在 data 文件夹运行命令行 "),a("code",[t._v("json-server --watch data.json -p 3008")]),t._v("，(data.json 为 json 文件的文件名。)\n出现 hai 就是运行成功")])]),t._v(" "),a("h4",{attrs:{id:"json-文件格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#json-文件格式"}},[t._v("#")]),t._v(" json 文件格式")]),t._v(" "),a("p",[t._v("json 文件还被用来 ajax 请求传递数据的格式")]),t._v(" "),a("ul",[a("li",[t._v("创建的文件内容是一个对象，json 文件的格式有着严格的要求，最外层是一个{}，里面是多个对象。")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"posts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"userId"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("与对象格式基本一样，内部所有内容必须使用双引号（除数组和布尔值外）")]),t._v(" "),a("li",[t._v("最后一项后"),a("code",[t._v("不可以")]),t._v("添加逗号")])]),t._v(" "),a("h4",{attrs:{id:"发送请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#发送请求"}},[t._v("#")]),t._v(" 发送请求")]),t._v(" "),a("p",[t._v("注意：请求不能频繁发送，在数据更新后想要更新页面不可以采用重新发送请求的方式。在后台数据改变后想要更新视图应该通过 js 语法对页面上的已有数组进行操作修改以达到视图改变的目的，")]),t._v(" "),a("ul",[a("li",[t._v("3：安装运行依赖\n"),a("code",[t._v("npm i axios")])])]),t._v(" "),a("p",[t._v("请求方法：\nget 是获取,查\npost 添加，增\nput 替换 改\npatch 修改 改\n(put 是全部更新，patch 是局部更新)\n局部更新是更新对象里的一部分。\npatch 可以代替 put\nDELETE 删除")]),t._v(" "),a("p",[t._v("基础请求:\n完整请求由 前缀+地址+方法+参数\n以下请求只针对 json-server,实际情况以后台位准\n筛选：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("GET 前缀/posts?title=json-server&author=typicode\ntitle=json-server 并且 author=typicode")])]),t._v(" "),a("li",[a("p",[t._v("GET 前缀/posts?id=1&id=2 id=1 或 id=2")])]),t._v(" "),a("li",[a("p",[t._v("GET 前缀/comments?author.name=typicode")])]),t._v(" "),a("li",[a("p",[t._v("编辑\naxios.patch('前缀/comments/1',{text:'666'})\n将 text 这一项修改为 666.")]),t._v(" "),a("p",[t._v("分页：")])])]),t._v(" "),t._v("获取第七页的\n"),t._v("limit 是手动设置每页的条数，取某一页，不全部取\n"),a("p",[t._v("不设置的话默认 10 条 1 页")]),t._v(" "),a("p",[t._v("排序：")]),t._v(" "),a("p",[t._v("对所有文章通过 sort=views 升序")]),t._v(" "),a("p",[t._v("对第一篇文章下的评论进行排序")]),t._v(" "),a("p",[t._v("截取 slice")]),t._v(" "),a("p",[t._v("范围 Operators")]),t._v(" "),a("p",[t._v("全字查询 Full-text search")]),t._v(" "),a("p",[t._v("查询是否包含某一子属性 Relationships")]),t._v(" "),a("p",[t._v("包含（支持正则表达式。）\nGET /posts?title_like=server")]),t._v(" "),a("h4",{attrs:{id:"配置-axios"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置-axios"}},[t._v("#")]),t._v(" 配置 axios")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//封装axios")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" axios "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"axios"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Vue "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\naxios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaults"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("baseURL "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost:3008/"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\naxios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaults"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\naxios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建为全局文件")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$axios "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" axios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" axios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 需要导入main.js;上来进行组件全局注册")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./pligins/axios"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h4",{attrs:{id:"设置请求头"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置请求头"}},[t._v("#")]),t._v(" 设置请求头")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在axios.js里")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这里设置的是请求头的 Authorization 项")]),t._v("\naxios"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("interceptors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Authorization "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sessionStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"token"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);